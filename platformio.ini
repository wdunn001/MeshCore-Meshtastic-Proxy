[env:lora32u4II]
platform = atmelavr
board = lora32u4II
framework = arduino

; MCU Configuration
board_build.mcu = atmega32u4
board_build.f_cpu = 8000000L

; Serial Monitor
monitor_speed = 115200
monitor_filters = 
    default

; Build flags
build_flags = 
    -DF_CPU=8000000L
    -DARDUINO_AVR_LEONARDO
    ; USB_VID and USB_PID are defined by Arduino framework, don't override
    -Wno-unused-value
    ; Suppress warnings from Arduino framework USBCore.cpp LED macros
    ; (LoRa32u4 II doesn't have USB status LEDs)
    -I src/platforms/lora32u4ii
    -I src/platforms/rak4631
    -I src/platforms
    -I src/radio
    -I src/radio/sx1276_direct
    -I src/radio/sx1262_radiolib
    -I src/protocols
    -I src/protocols/meshcore
    -I src/protocols/meshtastic

; Library dependencies - LoRa32u4II uses direct SPI, no RadioLib needed
lib_deps = 

; Exclude RAK4631-specific files and RadioLib implementations (using direct SPI for SX1276)
src_filter = 
    +<*>
    -<radio/sx1262_direct/*>
    -<radio/sx1276_radiolib/*>
    -<radio/sx1262_radiolib/*>
    -<platforms/rak4631/*>
    -<sx1276.cpp>

; Upload settings
upload_speed = 19200
; Slower speed for more reliable uploads with bootloader
upload_protocol = avr109
upload_flags = 
    -p$UPLOAD_PORT
    -b$UPLOAD_SPEED
    -P$UPLOAD_PORT
    -D
; -D flag disables auto-erase (sometimes helps with bootloader timing)
; Note: You MUST double-press RESET button before uploading! 
; The bootloader is only active for ~8 seconds after double-press

[env:rak4631]
platform = nordicnrf52
board = rak4631
framework = arduino
; Use same framework version as Meshtastic (they use a custom fork, but standard should work)
platform_packages =
    framework-arduinoadafruitnrf52 @ 1.10700.0

; Build flags
build_flags = 
    -DRAK4631_BOARD
    -DRADIO_SX1262
    -DARDUINO_NRF52840_FEATHER
    -DNRF52840_XXAA
    -w
    -DNDEBUG
    -I src/platforms/rak4631
    -I src/platforms/lora32u4ii
    -I src/radio
    -I src/radio/sx1276_radiolib
    -I src/radio/sx1262_radiolib
    -I src/protocols
    -I src/protocols/meshcore
    -I src/protocols/meshtastic
    -I src/platforms
    -I include
    -include include/BuildOptUser.h

; Exclude ATmega-specific files and direct implementations (using RadioLib now)
src_filter = 
    +<*>
    -<radio/sx1276_direct/*>
    -<radio/sx1262_direct/*>
    -<platforms/lora32u4ii/*>
    -<sx1276.cpp>

; Library dependencies
lib_deps = 
    SPI
    Wire
    jgromes/RadioLib

; Serial Monitor
monitor_speed = 115200
monitor_filters = 
    default

; Upload settings
upload_protocol = nrfutil
upload_speed = 115200
